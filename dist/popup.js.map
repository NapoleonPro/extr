{"version":3,"file":"popup.js","mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://extr/./src/popup/popup.ts"],"sourcesContent":["\"use strict\";\n// Popup Controller with Model Warm-up\n// File: src/popup/popup.ts\nconsole.log('Popup loaded!');\nconst startBtn = document.getElementById('startBtn');\nlet isTranscribing = false;\nlet isWarmingUp = false;\n// üöÄ WARM-UP MODEL ON POPUP OPEN\nasync function warmUpModelInBackground() {\n    if (isWarmingUp)\n        return;\n    isWarmingUp = true;\n    console.log('üî• Triggering model warm-up...');\n    try {\n        const response = await chrome.runtime.sendMessage({ action: 'warmUp' });\n        console.log('Warm-up response:', response);\n    }\n    catch (error) {\n        console.warn('Warm-up failed:', error);\n    }\n    finally {\n        isWarmingUp = false;\n    }\n}\n// Warm-up model immediately when popup opens\nwarmUpModelInBackground();\nasync function ensureContentScriptLoaded(tabId) {\n    try {\n        const response = await chrome.tabs.sendMessage(tabId, { action: 'ping' });\n        console.log('Content script ping response:', response);\n        return true;\n    }\n    catch (error) {\n        console.log('Content script not loaded, injecting...');\n        try {\n            await chrome.scripting.executeScript({\n                target: { tabId },\n                files: ['content.js']\n            });\n            await new Promise(resolve => setTimeout(resolve, 200));\n            return true;\n        }\n        catch (injectError) {\n            console.error('Failed to inject content script:', injectError);\n            return false;\n        }\n    }\n}\nfunction updateUI(transcribing) {\n    isTranscribing = transcribing;\n    startBtn.disabled = transcribing;\n}\nstartBtn?.addEventListener('click', async () => {\n    console.log('Start clicked!');\n    try {\n        const [tab] = await chrome.tabs.query({ active: true, currentWindow: true });\n        if (!tab.id) {\n            alert('‚ùå Error: No active tab found');\n            return;\n        }\n        if (tab.url?.startsWith('chrome://') || tab.url?.startsWith('edge://')) {\n            alert('‚ùå Cannot run on browser internal pages.\\nPlease navigate to a regular webpage.');\n            return;\n        }\n        const isLoaded = await ensureContentScriptLoaded(tab.id);\n        if (!isLoaded) {\n            alert('‚ùå Failed to load extension on this page.\\nTry refreshing the page or using a different website.');\n            return;\n        }\n        const useSystemAudio = true;\n        console.log('Starting transcription with audio source: system');\n        chrome.tabs.sendMessage(tab.id, {\n            action: 'start',\n            useSystemAudio: useSystemAudio\n        }, (response) => {\n            if (chrome.runtime.lastError) {\n                console.error('Error:', chrome.runtime.lastError.message);\n                alert('‚ùå Error: ' + chrome.runtime.lastError.message);\n                return;\n            }\n            console.log('Start response:', response);\n            if (response?.success) {\n                updateUI(true);\n                // Overlay will appear automatically with STOP button\n            }\n            else {\n                alert('‚ùå Failed to start: ' + (response?.message || 'Unknown error'));\n            }\n        });\n    }\n    catch (error) {\n        console.error('Error starting transcription:', error);\n        alert('‚ùå Error: ' + error);\n    }\n});\nupdateUI(false);\nconsole.log('Popup ready!');\n"],"names":[],"sourceRoot":""}