{"version":3,"file":"popup.js","mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://extr/./src/popup/popup.ts"],"sourcesContent":["\"use strict\";\n// Simplified Popup Controller - System Audio Only\n// File: src/popup/popup.ts\nconsole.log('Popup loaded!');\nconst startBtn = document.getElementById('startBtn');\nconst stopBtn = document.getElementById('stopBtn');\nconst statusIndicator = document.getElementById('statusIndicator');\nlet isTranscribing = false;\n// Check if content script is loaded\nasync function ensureContentScriptLoaded(tabId) {\n    try {\n        const response = await chrome.tabs.sendMessage(tabId, { action: 'ping' });\n        console.log('Content script ping response:', response);\n        return true;\n    }\n    catch (error) {\n        console.log('Content script not loaded, injecting...');\n        try {\n            await chrome.scripting.executeScript({\n                target: { tabId },\n                files: ['content.js']\n            });\n            await new Promise(resolve => setTimeout(resolve, 200));\n            return true;\n        }\n        catch (injectError) {\n            console.error('Failed to inject content script:', injectError);\n            return false;\n        }\n    }\n}\n// Update UI state\nfunction updateUI(transcribing) {\n    isTranscribing = transcribing;\n    if (transcribing) {\n        startBtn.disabled = true;\n        stopBtn.disabled = false;\n        statusIndicator.classList.add('active');\n    }\n    else {\n        startBtn.disabled = false;\n        stopBtn.disabled = true;\n        statusIndicator.classList.remove('active');\n    }\n}\n// Start transcription\nstartBtn?.addEventListener('click', async () => {\n    console.log('Start clicked!');\n    try {\n        const [tab] = await chrome.tabs.query({ active: true, currentWindow: true });\n        if (!tab.id) {\n            alert('❌ Error: No active tab found');\n            return;\n        }\n        // Check if it's a restricted page\n        if (tab.url?.startsWith('chrome://') || tab.url?.startsWith('edge://')) {\n            alert('❌ Cannot run on browser internal pages.\\nPlease navigate to a regular webpage.');\n            return;\n        }\n        // Ensure content script is loaded\n        const isLoaded = await ensureContentScriptLoaded(tab.id);\n        if (!isLoaded) {\n            alert('❌ Failed to load extension on this page.\\nTry refreshing the page or using a different website.');\n            return;\n        }\n        // Hardcoded to system audio as per UI\n        const useSystemAudio = true;\n        console.log('Starting transcription with audio source: system');\n        // Send start message\n        chrome.tabs.sendMessage(tab.id, {\n            action: 'start',\n            useSystemAudio: useSystemAudio\n        }, (response) => {\n            if (chrome.runtime.lastError) {\n                console.error('Error:', chrome.runtime.lastError.message);\n                alert('❌ Error: ' + chrome.runtime.lastError.message);\n                return;\n            }\n            console.log('Start response:', response);\n            if (response?.success) {\n                updateUI(true);\n                // Show success notification\n                if (useSystemAudio) {\n                    alert('✅ Started! Please select the tab/window to capture audio from.');\n                }\n            }\n            else {\n                alert('❌ Failed to start: ' + (response?.message || 'Unknown error'));\n            }\n        });\n    }\n    catch (error) {\n        console.error('Error starting transcription:', error);\n        alert('❌ Error: ' + error);\n    }\n});\n// Stop transcription\nstopBtn?.addEventListener('click', async () => {\n    console.log('Stop clicked!');\n    try {\n        const [tab] = await chrome.tabs.query({ active: true, currentWindow: true });\n        if (!tab.id)\n            return;\n        chrome.tabs.sendMessage(tab.id, { action: 'stop' }, (response) => {\n            console.log('Stop response:', response);\n            updateUI(false);\n        });\n    }\n    catch (error) {\n        console.error('Error stopping transcription:', error);\n        updateUI(false);\n    }\n});\n// Initialize UI\nupdateUI(false);\n"],"names":[],"sourceRoot":""}